<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Omaha Affordable Housing | All-In for Our Neighbors</title>
  <meta name="description" content="Join a heart-led movement to end housing instability in Omaha. Your gift moves a family from the edge to home." />
  <link rel="stylesheet" href="/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    :root{
      --ink:#0f172a;--muted:#475569;--brand:#0ea5e9;--brand-2:#2563eb;--good:#16a34a;--bg:#f8fafc;--card:#ffffff;--ring:rgba(37,99,235,.2);
    }
    *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.65}
    a{color:var(--brand-2);text-decoration:none}

    <link rel="preload" as="image" href="/public/assets/irony1.jpg">
<link rel="preload" as="image" href="/public/assets/rain.png">
<link rel="preload" as="image" href="/public/assets/elder.jpg">
<link rel="preload" as="image" href="/public/assets/skyline.png">

    <style>
  .carousel {
    position: relative;
    overflow: hidden;
    border-radius: 16px;
  }
  .carousel-track {
    display: flex;
    scroll-snap-type: x mandatory;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }
  .carousel-slide {
    flex: 0 0 100%;
    scroll-snap-align: center;
    position: relative;
    aspect-ratio: 16 / 9; /* ensures height */
    background: #222;
  }
  .carousel-slide img {
    width: 100%; height: 100%; object-fit: cover; display: block;
  }
  .carousel-nav {
    position: absolute; inset: 0; display: flex; align-items: center; justify-content: space-between;
    pointer-events: none; padding: 0 8px;
  }
  .carousel-btn {
    pointer-events: all; border: 0; background: rgba(0,0,0,.5); color: #fff; width: 44px; height: 44px;
    border-radius: 999px; font-size: 20px; line-height: 44px; cursor: pointer;
  }
  .carousel-dots {
    position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 8px;
  }
  .carousel-dot {
    width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,.5); border: 0;
  }
  .carousel-dot.active { background: #fff; }
</style>

<div class="carousel" id="heroCarousel">
  <div class="carousel-track" aria-label="Image carousel">
    <div class="carousel-slide"><img src="/public/assets/irony1.jpg" alt="Homelessness poses profound mental and emotional strains."></div>
    <div class="carousel-slide"><img src="/public/assets/rain.png" alt="Direct-to-housing placement"></div>
    <div class="carousel-slide"><img src="/public/assets/elder.jpg" alt="In 2024, there were 32,882 homeless veterans in the U.S."></div>
    <div class="carousel-slide"><img src="/public/assets/skyline.png" alt="Fedral law is aiming to criminalize homelessness"></div>
  </div>
  <div class="carousel-nav">
    <button class="carousel-btn" data-dir="-1" aria-label="Previous slide">‹</button>
    <button class="carousel-btn" data-dir="1" aria-label="Next slide">›</button>
  </div>
  <div class="carousel-dots" aria-hidden="true"></div>
</div>

<script>
(function () {
  const root = document.getElementById('heroCarousel');
  const track = root.querySelector('.carousel-track');
  const slides = Array.from(root.querySelectorAll('.carousel-slide'));
  const dotsWrap = root.querySelector('.carousel-dots');
  const prev = root.querySelector('[data-dir="-1"]');
  const next = root.querySelector('[data-dir="1"]');

  // Build dots
  slides.forEach((_, i) => {
    const b = document.createElement('button');
    b.className = 'carousel-dot' + (i === 0 ? ' active' : '');
    b.addEventListener('click', () => track.scrollTo({ left: i * track.clientWidth, behavior: 'smooth' }));
    dotsWrap.appendChild(b);
  });

  const dots = Array.from(root.querySelectorAll('.carousel-dot'));
  function updateDots() {
    const idx = Math.round(track.scrollLeft / track.clientWidth);
    dots.forEach((d, i) => d.classList.toggle('active', i === idx));
  }
  track.addEventListener('scroll', () => requestAnimationFrame(updateDots));

  function go(dir) {
    const idx = Math.round(track.scrollLeft / track.clientWidth);
    const nextIdx = Math.max(0, Math.min(slides.length - 1, idx + dir));
    track.scrollTo({ left: nextIdx * track.clientWidth, behavior: 'smooth' });
  }
  prev.addEventListener('click', () => go(-1));
  next.addEventListener('click', () => go(1));

  // Resize handler keeps slide widths aligned
  window.addEventListener('resize', () => {
    const idx = Math.round(track.scrollLeft / track.clientWidth);
    track.scrollTo({ left: idx * track.clientWidth });
  });
})();
</script>


    /* Header Carousel */
    header.hero{position:relative;min-height:92vh;display:grid;place-items:center;overflow:hidden;color:#fff}
    .slides{position:absolute;inset:0;display:grid}
    .slide{position:absolute;inset:0;background-position:center;background-size:cover;filter:brightness(.65);opacity:0;transition:opacity 900ms ease}
    .slide.active{opacity:1}
    .scrim{position:absolute;inset:0;background:radial-gradient(1200px 600px at 50% 65%, transparent, rgba(0,0,0,.55))}
    .hero-content{position:relative;z-index:2;max-width:1100px;padding:24px;text-align:center}
    .eyebrow{display:inline-block;padding:.35rem .65rem;border-radius:999px;background:rgba(255,255,255,.15);backdrop-filter:blur(6px);font-weight:700;letter-spacing:.08em}
    h1{font-size:clamp(2rem,5vw,4rem);margin:.75rem 0 1rem;font-weight:800}
    .sub{font-size:clamp(1.05rem,2.5vw,1.35rem);opacity:.95;max-width:900px;margin:0 auto 1.25rem}

    .cta-row{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap;margin-top:1.25rem}
    .btn{appearance:none;border:0;border-radius:12px;padding:14px 22px;font-weight:800;cursor:pointer}
    .btn-primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;box-shadow:0 12px 24px rgba(37,99,235,.25)}
    .btn-primary:focus,.btn-primary:hover{outline:0;box-shadow:0 0 0 6px var(--ring),0 12px 24px rgba(2,6,23,.35)}
    .btn-ghost{background:rgba(255,255,255,.14);color:#fff;border:1px solid rgba(255,255,255,.22)}

    /* Progress Card */
    .container{max-width:1200px;margin:0 auto;padding:32px 20px}
    .card{background:var(--card);border:1px solid #e2e8f0;border-radius:20px;box-shadow:0 8px 24px rgba(2,6,23,.06);padding:28px}
    .progress-wrap{display:grid;gap:16px}
    .progress{height:14px;background:#e2e8f0;border-radius:999px;overflow:hidden}
    .bar{height:100%;width:0;background:linear-gradient(90deg,var(--good),#22c55e);transition:width 900ms ease}
    .stats{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
    .stat{padding:16px;border:1px solid #e2e8f0;border-radius:14px;text-align:center}
    .kpi{font-size:1.55rem;font-weight:800;color:var(--brand-2)} .label{color:var(--muted);font-weight:600}

    /* Sections */
    section{margin:42px 0}
    h2{font-size:clamp(1.4rem,3.5vw,2.25rem);margin:.25rem 0 10px;font-weight:800}
    p.lead{font-size:1.125rem;color:#0b1324}
    .grid{display:grid;gap:18px}
    .goals{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
    .goal{padding:18px 16px;border:1px dashed #dbe3ef;border-radius:14px;background:#fff}
    .goal strong{color:var(--brand-2)}

    /* Donation box */
    aside.donate{position:sticky;top:18px}
    .amounts{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:14px 0}
    .chip{padding:10px 12px;border-radius:12px;border:1px solid #e2e8f0;background:#fff;font-weight:700;cursor:pointer;text-align:center}
    .chip.active{border-color:var(--brand-2);color:var(--brand-2);box-shadow:0 0 0 4px var(--ring)}
    .field{display:flex;gap:8px}
    .field input{flex:1;padding:12px 14px;border-radius:12px;border:1px solid #dfe3ea;font-weight:700}

    /* Footer */
    footer{background:#0b1324;color:#e6edf7;padding:36px 20px;margin-top:56px}
    .foot{max-width:1200px;margin:0 auto;display:grid;gap:8px}
    small.cites{opacity:.8}

    @media (max-width: 900px){
      .stats{grid-template-columns:1fr}
      .amounts{grid-template-columns:repeat(2,1fr)}
    }
  </style>
</head>
<body>
  <header class="hero" aria-label="Image carousel with call to action">
    
    <div class="scrim" aria-hidden="true"></div>
    <div class="slides" id="slides">
  <div class="slide active" style="background-image:url('/public/assets/irony1.jpg')"></div>
  <div class="slide" style="background-image:url('/public/assets/rain.png')"></div>
  <div class="slide" style="background-image:url('/public/assets/elder.jpg')"></div>
  <div class="slide" style="background-image:url('/public/assets/skyline.png')"></div>
</div>

    <div class="hero-content">
      <span class="eyebrow">A Heart-Led Movement</span>
      <h1>Every Neighbor Deserves a Safe Place to Sleep</h1>
      <p class="sub">Together, we’re building a community where families aren’t punished for poverty and hope is stronger than hardship. Your gift moves a neighbor from the edge to home.</p>
      <div class="cta-row">
        <button id="donateNow" class="btn btn-primary">Donate Now</button>
        <a href="#how" class="btn btn-ghost">See how your gift helps</a>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="card" aria-live="polite">
      <div class="progress-wrap">
        <div style="display:flex;gap:12px;align-items:end;flex-wrap:wrap">
          <div>
            <div style="font-weight:800;font-size:1.85rem" id="raised">$0</div>
            <div class="label">of $1,000,000 goal</div>
          </div>
          <div style="margin-left:auto;font-weight:700;color:var(--muted)">
            Campaign Day <span id="day">1</span>
          </div>
        </div>
        <div class="progress" aria-label="Fundraising progress"><div id="bar" class="bar"></div></div>
        <div class="stats">
          <div class="stat"><div class="kpi" id="donors">0</div><div class="label">Donors</div></div>
          <div class="stat"><div class="kpi" id="families">0</div><div class="label">Families on the path to home</div></div>
          <div class="stat"><div class="kpi" id="daysLeft">365</div><div class="label">Days remaining</div></div>
        </div>
      </div>
    </div>

    <section id="how" class="grid" style="grid-template-columns:2fr 1fr;gap:22px">
      <article class="card">
        <h2>Why we act now</h2>
        <p class="lead">Housing costs keep rising while paychecks don’t. Some respond by pushing people out of sight. We respond by pulling people into community — with dignity, housing, and care.</p>
        <div class="grid goals">
          <div class="goal"><strong>$400,000</strong><br/>Emergency Housing Fund – keep families housed and safe tonight.</div>
          <div class="goal"><strong>$300,000</strong><br/>First Keys – down-payment help and coaching for first‑time buyers.</div>
          <div class="goal"><strong>$200,000</strong><br/>Innovation Lab – tiny homes, ADUs, motel conversions.</div>
          <div class="goal"><strong>$100,000</strong><br/>Operations & Impact – transparent delivery of every dollar.</div>
        </div>
      </article>

      <aside class="card donate">
        <h2 style="margin-bottom:6px">Make a gift</h2>
        <div class="amounts" id="amounts">
          <button class="chip" data-amt="25">$25</button>
          <button class="chip" data-amt="50">$50</button>
          <button class="chip" data-amt="100">$100</button>
          <button class="chip" data-amt="250">$250</button>
          <button class="chip" data-amt="500">$500</button>
          <button class="chip" data-amt="1000">$1,000</button>
        </div>
        <div class="field">
          <input id="custom" type="number" min="1" step="1" placeholder="Other amount (USD)" aria-label="Custom amount"/>
          <button id="give" class="btn btn-primary" style="white-space:nowrap">Give</button>
        </div>
        <p class="label" style="margin-top:8px">Payments are processed securely by Stripe.</p>
      </aside>
    </section>

    <section class="card">
      <h2>What your gift makes possible</h2>
      <p class="lead">From the first hot shower to a signed lease, your generosity fuels each step. When we invest in people, we don’t just reduce homelessness — we grow a stronger Omaha.</p>
      <div class="grid goals">
        <div class="goal"><strong>Street‑to‑Home</strong><br/>Rapid placements from encampments and cars into safe rooms and supportive housing.</div>
        <div class="goal"><strong>Care, not cuffs</strong><br/>On‑site case managers connect neighbors to mental health and recovery care alongside housing.</div>
        <div class="goal"><strong>Lasting stability</strong><br/>Financial coaching, job support, and tenant protections that keep families housed.</div>
      </div>
    </section>
  </div>

  <footer>
    <div class="foot">
      <strong>Omaha Affordable Housing Campaign</strong>
      <small>PacMac Mobile LLC • housing@P3Lending.space • 402‑915‑1434 • 1402 Jones St, Omaha, NE 68901</small>
    </div>
  </footer>

  <script>
    let stripe; // set after page loads
    let selected = 50; // default for quick donate

    function setActive(btn){
      document.querySelectorAll('.chip').forEach(b=>b.classList.remove('active'));
      if(btn){btn.classList.add('active');}
    }

    async function updateStats(){
      try{
        const res = await fetch('/api/campaign-stats');
        const data = await res.json();
        const pct = Math.min(100, (data.currentAmount / data.goal) * 100);
        document.getElementById('raised').textContent = `$${Number(data.currentAmount).toLocaleString()}`;
        document.getElementById('donors').textContent = Number(data.donorCount).toLocaleString();
        document.getElementById('families').textContent = Number(data.familiesHelped).toLocaleString();
        document.getElementById('bar').style.width = pct + '%';

        const start = new Date('2025-08-13');
        const end = new Date('2026-08-13');
        const today = new Date();
        const day = Math.max(1, Math.ceil((today - start)/(1000*60*60*24)));
        const daysLeft = Math.max(0, Math.ceil((end - today)/(1000*60*60*24)));
        document.getElementById('day').textContent = day;
        document.getElementById('daysLeft').textContent = daysLeft;
      }catch(e){console.warn('Stats unavailable', e)}
    }

    async function createCheckout(amount){
      const res = await fetch('/api/create-checkout-session',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({amount:amount})
      });
      if(!res.ok){throw new Error('Checkout session failed')}
      const {url} = await res.json();
      window.location.href = url;
    }

    function wireDonations(){
      document.getElementById('donateNow').addEventListener('click',()=>createCheckout(selected));
      document.getElementById('give').addEventListener('click',()=>{
        const val = parseInt(document.getElementById('custom').value,10);
        const amount = Number.isFinite(val) && val>0 ? val : selected;
        createCheckout(amount).catch(()=>alert('Could not start checkout. Please try again.'));
      });
      document.querySelectorAll('.chip').forEach(btn=>{
        btn.addEventListener('click',()=>{
          selected = parseInt(btn.dataset.amt,10);
          document.getElementById('custom').value = '';
          setActive(btn);
        });
      });
      // default select $50
      const def = document.querySelector('.chip[data-amt="50"]');
      if(def){setActive(def)}
    }

    function startCarousel(){
      const slides = Array.from(document.querySelectorAll('.slide'));
      let i = 0; setInterval(()=>{slides[i].classList.remove('active'); i=(i+1)%slides.length; slides[i].classList.add('active');}, 5200);
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      try{ stripe = Stripe('{{STRIPE_PUBLISHABLE_KEY}}'); }catch(e){ console.warn('Stripe key missing'); }
      await updateStats();
      wireDonations();
      startCarousel();
    });
  </script>
</body>
</html>
